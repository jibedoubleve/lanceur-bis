# Lua Script Database

A collection of ready-to-use Lua script examples for Lanceur aliases. Each script can be copied directly into the [Lua editor](pages/usermanual/4.lua-scripting.md) and adapted to your needs.

> **Tip:** Use your browser's built-in search (`Ctrl+F`) to quickly find a script by keyword.

---

## Route Parameters to Different Environments

**Use case:** You have a single alias (e.g. a web application URL) and want to open a different environment depending on the parameter you type.

**How it works:** The script checks `context.Parameters` and rewrites it to the matching environment URL. If no known parameter is provided, the alias runs with its original settings unchanged.

**Example:** An alias named `myapp` with this script lets you type `myapp dev`, `myapp test`, or `myapp prod` to open the corresponding environment.

```lua
if context.Parameters == "dev" then
    context.Parameters = "https://dev.myapp.example.com"
    return context
end

if context.Parameters == "test" then
    context.Parameters = "https://test.myapp.example.com"
    return context
end

if context.Parameters == "prod" then
    context.Parameters = "https://prod.myapp.example.com"
    return context
end
```

**Setup:** Configure the alias `FileName` to your browser executable (e.g. `firefox.exe`) and paste this script into the Lua editor. Adjust the URLs to match your actual environments.

---

## Auto-Detect the Latest Installed Version of an Application

**Use case:** An application (e.g. an IDE) installs each version into a separate folder. You want your alias to always launch the most recently updated version without manually editing the path after every update.

**How it works:** The script defines a list of directories where the application might be installed. It scans these directories for subfolders matching a name pattern, compares their last-modified timestamps, and sets `context.FileName` to the executable inside the most recent folder.

**Example:** You have an IDE that installs versions into `%LocalAppData%\Programs\MyIDE\` or `%ProgramFiles%\Vendor\`. Each update creates a new folder (e.g. `MyIDE 2025.1`, `MyIDE 2025.2`). This script finds the newest one and launches it.

```lua
luanet.load_assembly("System")
luanet.load_assembly("System.IO")

local Environment = luanet.import_type("System.Environment")
local Path = luanet.import_type("System.IO.Path")
local Directory = luanet.import_type("System.IO.Directory")
local DirectoryInfo = luanet.import_type("System.IO.DirectoryInfo")
local SpecialFolder = luanet.import_type("System.Environment+SpecialFolder")

---------------------------------------
-- CONFIGURATION: edit these variables
---------------------------------------
local dirPattern    = "*MyIDE*"        -- pattern to match installation folders
local exeRelPath    = { "bin", "app.exe" } -- path to the executable relative to the installation folder
local searchPaths   = {                -- directories where the application might be installed
    { SpecialFolder.LocalApplicationData, "Programs", "MyIDE" },
    { SpecialFolder.ProgramFiles, "Vendor" }
}
---------------------------------------

-- Collect all matching subdirectories
local candidateDirs = {}

for _, parts in ipairs(searchPaths) do
    local basePath = Environment.GetFolderPath(parts[1])
    for i = 2, #parts do
        basePath = Path.Combine(basePath, parts[i])
    end

    if Directory.Exists(basePath) then
        local dirs = Directory.GetDirectories(basePath, dirPattern)
        for i = 0, dirs.Length - 1 do
            table.insert(candidateDirs, dirs[i])
        end
    end
end

-- Find the most recently modified directory
local latestDir = nil
local latestTime = nil

for _, dirPath in ipairs(candidateDirs) do
    local dirInfo = DirectoryInfo(dirPath)
    local writeTime = dirInfo.LastWriteTime

    if latestTime == nil or writeTime > latestTime then
        latestTime = writeTime
        latestDir = dirInfo
    end
end

-- Update the alias to point to the executable
if latestDir ~= nil then
    local exePath = latestDir.FullName
    for _, segment in ipairs(exeRelPath) do
        exePath = Path.Combine(exePath, segment)
    end
    context.FileName = exePath
end
```

**Setup:** Only edit the three variables in the **CONFIGURATION** block at the top:

| Variable | Purpose | Example |
| --- | --- | --- |
| `dirPattern` | Glob pattern to match installation folders | `"*Rider*"`, `"*Code*"` |
| `exeRelPath` | Path segments from the installation folder to the executable | `{ "bin", "rider64.exe" }` |
| `searchPaths` | List of base directories to scan (each entry is a special folder + subfolder segments) | `{ SpecialFolder.ProgramFiles, "JetBrains" }` |
